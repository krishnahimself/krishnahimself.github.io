<!doctype html>









































<html
  class="not-ready lg:text-base"
  style="--bg: #faf8f1"
  lang="en-us"
>
  <head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta
    name="viewport"
    content="width=device-width, initial-scale=1, shrink-to-fit=no"
  />

  
  <title>How to use Spatie Laravel View Models with Inertia JS and Vue 3 - Krishna Bhandari</title>

  
  <meta name="theme-color" />

  
  
  
  
  <meta name="description" content="View models are a useful concept for passing data to the view. They help clean up the code and allow us to reuse similar data, usually in our create and update forms.
Problem: Recently, I was working on a VILT (Vue, Inertia, Laravel &amp; Tailwind) Stack project where there was a lot of data that needed to be passed to the view for the create form. Almost the same data needed to be passed to the update form as well, which caused duplication and made the controller look messy." />
  <meta name="author" content="Krishna Bhandari" />
  

  
  
  
  
  
  
  <link rel="preload stylesheet" as="style" href="http://localhost:1313/main.min.css" />

  
  
  
  
  
  <link rel="preload" as="image" href="http://localhost:1313/theme.png" />

  
  
  
  
  <link rel="preload" as="image" href="https://avatars.githubusercontent.com/u/19906424?v=4" />
  
  

  
  
  <link rel="preload" as="image" href="http://localhost:1313/twitter.svg" />
  
  <link rel="preload" as="image" href="http://localhost:1313/github.svg" />
  
  <link rel="preload" as="image" href="http://localhost:1313/instagram.svg" />
  
  <link rel="preload" as="image" href="http://localhost:1313/linkedin.svg" />
  
  

  
  
  <script
    defer
    src="http://localhost:1313/highlight.min.js"
    onload="hljs.initHighlightingOnLoad();"
  ></script>
  

  
  
  

  
  <link rel="icon" href="http://localhost:1313/favicon.ico" />
  <link rel="apple-touch-icon" href="http://localhost:1313/apple-touch-icon.png" />

  
  <meta name="generator" content="Hugo 0.129.0">

  
  
  
</head>

  <body class="text-black duration-200 ease-out dark:text-white">
    <header class="mx-auto flex h-[4.5rem] max-w-3xl px-8 lg:justify-center">
  <div class="relative z-50 mr-auto flex items-center">
    <a
      class="-translate-x-[1px] -translate-y-[1px] text-2xl font-semibold"
      href="http://localhost:1313/"
      >Krishna Bhandari</a
    >
    <div
      class="btn-dark text-[0] ml-4 h-6 w-6 shrink-0 cursor-pointer [background:url(./theme.png)_left_center/_auto_theme('spacing.6')_no-repeat] [transition:_background-position_0.4s_steps(5)] dark:[background-position:right]"
      role="button"
      aria-label="Dark"
    ></div>
  </div>

  <div
    class="btn-menu relative z-50 -mr-8 flex h-[4.5rem] w-[5rem] shrink-0 cursor-pointer flex-col items-center justify-center gap-2.5 lg:hidden"
    role="button"
    aria-label="Menu"
  ></div>

  

  <script>
    
    const htmlClass = document.documentElement.classList;
    setTimeout(() => {
      htmlClass.remove('not-ready');
    }, 10);

    
    const btnMenu = document.querySelector('.btn-menu');
    btnMenu.addEventListener('click', () => {
      htmlClass.toggle('open');
    });

    
    const metaTheme = document.querySelector('meta[name="theme-color"]');
    const lightBg = '#faf8f1'.replace(/"/g, '');
    const setDark = (isDark) => {
      metaTheme.setAttribute('content', isDark ? '#000' : lightBg);
      htmlClass[isDark ? 'add' : 'remove']('dark');
      localStorage.setItem('dark', isDark);
    };

    
    const darkScheme = window.matchMedia('(prefers-color-scheme: dark)');
    if (htmlClass.contains('dark')) {
      setDark(true);
    } else {
      const darkVal = localStorage.getItem('dark');
      setDark(darkVal ? darkVal === 'true' : darkScheme.matches);
    }

    
    darkScheme.addEventListener('change', (event) => {
      setDark(event.matches);
    });

    
    const btnDark = document.querySelector('.btn-dark');
    btnDark.addEventListener('click', () => {
      setDark(localStorage.getItem('dark') !== 'true');
    });
  </script>

  <div
    class="nav-wrapper fixed inset-x-0 top-full z-40 flex h-full select-none flex-col justify-center pb-16 duration-200 dark:bg-black lg:static lg:h-auto lg:flex-row lg:!bg-transparent lg:pb-0 lg:transition-none"
  >
    
    
    <nav class="lg:ml-12 lg:flex lg:flex-row lg:items-center lg:space-x-6">
      
      <a
        class="block text-center text-2xl leading-[5rem] lg:text-base lg:font-normal"
        href="/about/"
        >About</a
      >
      
      <a
        class="block text-center text-2xl leading-[5rem] lg:text-base lg:font-normal"
        href="/contact/"
        >Contact</a
      >
      
    </nav>
    

    
    <nav
      class="mt-12 flex justify-center space-x-10 dark:invert lg:ml-12 lg:mt-0 lg:items-center lg:space-x-6"
    >
      
      <a
        class="h-8 w-8 text-[0] [background:var(--url)_center_center/cover_no-repeat] lg:h-6 lg:w-6"
        style="--url: url(./twitter.svg)"
        href="https://twitter.com/krishna8723"
        target="_blank"
        rel="me"
      >
        twitter
      </a>
      
      <a
        class="h-8 w-8 text-[0] [background:var(--url)_center_center/cover_no-repeat] lg:h-6 lg:w-6"
        style="--url: url(./github.svg)"
        href="https://github.com/krishnahimself"
        target="_blank"
        rel="me"
      >
        github
      </a>
      
      <a
        class="h-8 w-8 text-[0] [background:var(--url)_center_center/cover_no-repeat] lg:h-6 lg:w-6"
        style="--url: url(./instagram.svg)"
        href="https://instagram.com/YOUR_INSTAGRAM_ID"
        target="_blank"
        rel="me"
      >
        instagram
      </a>
      
      <a
        class="h-8 w-8 text-[0] [background:var(--url)_center_center/cover_no-repeat] lg:h-6 lg:w-6"
        style="--url: url(./linkedin.svg)"
        href="https://linkedin.com/in/YOUR_LINKEDIN_ID"
        target="_blank"
        rel="me"
      >
        linkedin
      </a>
      
    </nav>
    
  </div>
</header>


    <main
      class="prose prose-neutral relative mx-auto min-h-[calc(100%-9rem)] max-w-3xl px-8 pb-16 pt-12 dark:prose-invert"
    >
      

<article>
  <header class="mb-16">
    <h1 class="!my-0 pb-2.5">How to use Spatie Laravel View Models with Inertia JS and Vue 3</h1>

    
    <div class="text-sm antialiased opacity-60">
      
      <time>Jul 28, 2024</time>
      
      
      
      
    </div>
    
  </header>

  <section><p>View models are a useful concept for passing data to the view. They help clean up the code and allow us to reuse similar data, usually in our create and update forms.</p>
<h3 id="problem">Problem:</h3>
<p>Recently, I was working on a VILT (Vue, Inertia, Laravel &amp; Tailwind) Stack project where there was a lot of data that needed to be passed to the view for the create form. Almost the same data needed to be passed to the update form as well, which caused duplication and made the controller look messy. To clean things up, I used Spatie Laravel View Models to pass data to the view, and I was using Inertia along with Vue for the frontend.</p>
<p>Here is an example of the data that I needed to pass from the controller&rsquo;s create method:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-php" data-lang="php"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">function</span> <span style="color:#a6e22e">create</span>()<span style="color:#f92672">:</span> <span style="color:#a6e22e">Response</span>
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// Example data
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    $categories <span style="color:#f92672">=</span> <span style="color:#a6e22e">Category</span><span style="color:#f92672">::</span><span style="color:#a6e22e">latest</span>()<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">get</span>();
</span></span><span style="display:flex;"><span>    $branches <span style="color:#f92672">=</span> <span style="color:#a6e22e">Branch</span><span style="color:#f92672">::</span><span style="color:#a6e22e">latest</span>()<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">get</span>();
</span></span><span style="display:flex;"><span>    $candidates <span style="color:#f92672">=</span> <span style="color:#a6e22e">Candidate</span><span style="color:#f92672">::</span><span style="color:#a6e22e">query</span>()
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">// some complex query
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        <span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">paginate</span>();
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// And more +
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">Inertia</span><span style="color:#f92672">::</span><span style="color:#a6e22e">render</span>(<span style="color:#e6db74">&#39;SomeFile/Create&#39;</span>, [
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#39;categories&#39;</span> <span style="color:#f92672">=&gt;</span> $categories,
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#39;branches&#39;</span> <span style="color:#f92672">=&gt;</span> $branches,
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#39;candidates&#39;</span> <span style="color:#f92672">=&gt;</span> $candidates,
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">// And more.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    ]);
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>And, the same data needed to be passed to the edit page:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-php" data-lang="php"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">function</span> <span style="color:#a6e22e">edit</span>(<span style="color:#a6e22e">SomeModel</span> $someModel)<span style="color:#f92672">:</span> <span style="color:#a6e22e">Response</span>
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// Example data
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    $categories <span style="color:#f92672">=</span> <span style="color:#a6e22e">Category</span><span style="color:#f92672">::</span><span style="color:#a6e22e">latest</span>()<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">get</span>();
</span></span><span style="display:flex;"><span>    $branches <span style="color:#f92672">=</span> <span style="color:#a6e22e">Branch</span><span style="color:#f92672">::</span><span style="color:#a6e22e">latest</span>()<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">get</span>();
</span></span><span style="display:flex;"><span>    $candidates <span style="color:#f92672">=</span> <span style="color:#a6e22e">Candidate</span><span style="color:#f92672">::</span><span style="color:#a6e22e">query</span>()
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">// some complex query
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        <span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">paginate</span>();
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// And more +
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">Inertia</span><span style="color:#f92672">::</span><span style="color:#a6e22e">render</span>(<span style="color:#e6db74">&#39;SomeFile/Edit&#39;</span>, [
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#39;categories&#39;</span> <span style="color:#f92672">=&gt;</span> $categories,
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#39;branches&#39;</span> <span style="color:#f92672">=&gt;</span> $branches,
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#39;candidates&#39;</span> <span style="color:#f92672">=&gt;</span> $candidates,
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">// And more.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    ]);
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>To prevent this duplication and the messy-looking code, I used Spatie view models. Let me show you how to refactor it step by step, starting from the installation.</p>
<h3 id="installation">Installation</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>composer require spatie/laravel-view-models
</span></span></code></pre></div><h3 id="create-viewmodel-file">Create ViewModel File.</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>php artisan make:view-model SomepageViewModel
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-php" data-lang="php"><span style="display:flex;"><span><span style="color:#75715e">// SomepageViewModel
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">// SomepageViewModel
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">SomepageViewModel</span> <span style="color:#66d9ef">extends</span> <span style="color:#a6e22e">ViewModel</span>
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">function</span> __construct(<span style="color:#66d9ef">private</span> <span style="color:#a6e22e">readonly</span> <span style="color:#f92672">?</span><span style="color:#a6e22e">SomeModel</span> $someModel <span style="color:#f92672">=</span> <span style="color:#66d9ef">null</span>)
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">function</span> <span style="color:#a6e22e">someModel</span>()
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> (<span style="color:#f92672">!</span>$this<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">someModel</span>) {
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">null</span>;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> $this<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">someModel</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">function</span> <span style="color:#a6e22e">categories</span>()
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">Category</span><span style="color:#f92672">::</span><span style="color:#a6e22e">latest</span>()<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">get</span>();
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">function</span> <span style="color:#a6e22e">branches</span>()
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">Branch</span><span style="color:#f92672">::</span><span style="color:#a6e22e">latest</span>()<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">get</span>();
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">function</span> <span style="color:#a6e22e">candidates</span>()
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">Candidate</span><span style="color:#f92672">::</span><span style="color:#a6e22e">query</span>()
</span></span><span style="display:flex;"><span>            <span style="color:#75715e">// some complex query
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>            <span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">paginate</span>();
</span></span><span style="display:flex;"><span>            <span style="color:#75715e">// And more +
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// And more other functions
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>}
</span></span></code></pre></div><p>Now, let&rsquo;s use this view model in our controller&rsquo;s create and edit methods.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-php" data-lang="php"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">function</span> <span style="color:#a6e22e">create</span>()<span style="color:#f92672">:</span> <span style="color:#a6e22e">Response</span>
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    $viewModel <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#a6e22e">SomepageViewModel</span>();
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// Here we are calling toArray methods so that it will pass all the props
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#75715e">// that we specify in our vue file eg: defineProps({ categories: Object, branches: Object ...})
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">Inertia</span><span style="color:#f92672">::</span><span style="color:#a6e22e">render</span>(<span style="color:#e6db74">&#39;SomeFile/Create&#39;</span>, $viewModel<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">toArray</span>());
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>Similarly, we can use the view model in our edit method:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-php" data-lang="php"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">function</span> <span style="color:#a6e22e">edit</span>(<span style="color:#a6e22e">SomeModel</span> $someModel)<span style="color:#f92672">:</span> <span style="color:#a6e22e">Response</span>
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    $viewModel <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#a6e22e">SomepageViewModel</span>($someModel);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">Inertia</span><span style="color:#f92672">::</span><span style="color:#a6e22e">render</span>(<span style="color:#e6db74">&#39;SomeFile/Edit&#39;</span>, $viewModel<span style="color:#f92672">-&gt;</span><span style="color:#a6e22e">toArray</span>());
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>Finally, we refactored the code by introducing view models, which helped us remove the duplication and bulky code in our controller. I hope this post was helpful for you. Make sure to share this post with your friends. Cheers!</p>
</section>

  
  

  
  
  
  
  <nav class="mt-24 flex rounded-lg bg-black/[3%] text-lg dark:bg-white/[8%]">
    
    
    <a
      class="ml-auto flex w-1/2 items-center justify-end rounded-r-md p-6 pl-3 font-semibold no-underline hover:bg-black/[2%] dark:hover:bg-white/[3%]"
      href="http://localhost:1313/posts/sometime-we-overcomplicate-things/"
      ><span>Sometimes we overcomplicate things</span><span class="ml-1.5">→</span></a
    >
    
  </nav>
  
  

  
  

  
  

  


  
  <div class="giscus mt-24"></div>
  <script
    src="https://giscus.app/client.js"
    data-repo="YOUR_GISCUS_REPO"
    data-repo-id="YOUR_GISCUS_REPO_ID"
    data-category="YOUR__GISCUS_CATEGORY"
    data-category-id="YOUR_GISCUS_CATEGORY_ID"
    data-mapping="pathname"
    data-strict="1"
    data-reactions-enabled="0"
    data-emit-metadata="0"
    data-input-position="top"
    data-theme="light"
    data-lang="zh-CN"
    data-loading="lazy"
    crossorigin="anonymous"
    async
  ></script>
  
</article>


    </main>

    <footer
  class="opaco mx-auto flex h-[4.5rem] max-w-3xl items-center px-8 text-[0.9em] opacity-60"
>
  <div class="mr-auto">
    &copy; 2024
    <a class="link" href="http://localhost:1313/">Krishna Bhandari</a>
  </div>
  
  
</footer>

  </body>
</html>
